<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>GLOW - Geometric Light Oscillation Workstation</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŒ€</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@200..900&display=swap" rel="stylesheet">
    <link rel="manifest" href="assets/manifest.json">
    <meta name="theme-color" content="#000000">
    <!-- CSS Modules -->
    <link rel="stylesheet" href="src/styles/base.css">
    <link rel="stylesheet" href="src/styles/ui-components.css">
    <link rel="stylesheet" href="src/styles/side-panel.css">
    <link rel="stylesheet" href="src/styles/tablet-controls.css">
    <link rel="stylesheet" href="src/styles/crt-effects.css">
    <link rel="stylesheet" href="src/styles/modals.css">
    <!-- Tweakpane Theme -->
    <style>
    :root {
      --tp-base-background-color: hsla(0, 0%, 0%, 1.00);
      --tp-base-shadow-color: hsla(0, 0%, 0%, 0.2);
      --tp-button-background-color: hsla(0, 0%, 70%, 1.00);
      --tp-button-background-color-active: hsla(0, 0%, 85%, 1.00);
      --tp-button-background-color-focus: hsla(0, 0%, 80%, 1.00);
      --tp-button-background-color-hover: hsla(0, 0%, 75%, 1.00);
      --tp-button-foreground-color: hsla(0, 0%, 0%, 1.00);
      --tp-container-background-color: hsla(0, 0%, 10%, 1.00);
      --tp-container-background-color-active: hsla(0, 0%, 25%, 1.00);
      --tp-container-background-color-focus: hsla(0, 0%, 20%, 1.00);
      --tp-container-background-color-hover: hsla(0, 0%, 15%, 1.00);
      --tp-container-foreground-color: hsla(0, 0%, 50%, 1.00);
      --tp-groove-foreground-color: hsla(0, 0%, 10%, 1.00);
      --tp-input-background-color: hsla(0, 0%, 10%, 1.00);
      --tp-input-background-color-active: hsla(0, 0%, 25%, 1.00);
      --tp-input-background-color-focus: hsla(0, 0%, 20%, 1.00);
      --tp-input-background-color-hover: hsla(0, 0%, 15%, 1.00);
      --tp-input-foreground-color: hsla(131, 59%, 59%, 1.00);
      --tp-label-foreground-color: hsla(0, 0%, 50%, 1.00);
      --tp-monitor-background-color: hsla(0, 0%, 8%, 1.00);
      --tp-monitor-foreground-color: hsla(0, 0%, 48%, 1.00);
    }
    </style>
</head>
<body>
    <div id="logoContainer">
        <glow-logo></glow-logo>
        <h3>Geometric Light Oscillation Workstation</h3>
        <div class="logo-buttons">
            <button id="startButton">
                <ion-icon name="play-outline"></ion-icon>
                Start
            </button>
            <!-- <button id="openButtonLogo">
                <ion-icon name="shapes-outline"></ion-icon>
                Open
            </button> -->
        </div>
    </div>
    
    <div id="projectNameDisplay" class="project-name-display" style="display: none;">
        <span id="projectNameText" class="project-name-label">Untitled Project</span>
    </div>
    <button title="Tracks & Tablet" id="panelToggleButton" class="panel-toggle-btn" style="display: none;">
      <ion-icon title="Tracks & Tablet" name="cube-outline"></ion-icon>
    </button>
    <button title="Open Project" id="openButton" class="open-toggle-btn" style="display: none;">
      <ion-icon title="Open Project" name="folder-open-outline"></ion-icon>
    </button>
    <button title="Save Scene" id="saveButton" class="save-toggle-btn" style="display: none;">
      <ion-icon title="Save Scene" name="save-outline"></ion-icon>
    </button>
    <button title="About" id="infoButton" class="info-toggle-btn" style="display: none;">
      <ion-icon name="help-circle-outline"></ion-icon>
    </button>
    <canvas id="fluidBackgroundCanvas" style="position: absolute; top: 0; left: 0; z-index: 0; pointer-events: none;"></canvas>
    <canvas id="canvas"></canvas>
    <canvas id="tabletCanvas"></canvas>
    <div id="noiseOverlay" class="noise-overlay"></div>
    <div id="ditherOverlay" class="dither-overlay"></div>
    <div id="chromaticAberrationOverlay" class="chromatic-aberration-overlay"></div>
    <div id="midiDebugOverlay" class="midi-debug-overlay" style="display: none;"></div>
    <svg style="position: absolute; width: 0; height: 0;">
      <defs>
        <filter id="ditherFilter" color-interpolation-filters="sRGB" x="0" y="0" width="100%" height="100%">
          <feFlood flood-color="#000000" flood-opacity="0.50" x="0%" y="0%" result="flood"/>
          <feBlend mode="normal" x="0%" y="0%" in="SourceGraphic" in2="flood" result="blend1"/>
          <feImage class="ditherImage" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAA5ElEQVQYlQXBgQbCUABA0fdrk0ySSZJJkiRJMjOTTGZmkiRJZiYzyczMzGQmfdrtHPH7/TgcDuR5zna7pWka9vs9aZqyXq8R0+mU5/OJoihcLhfG4zFBENDtdjmdToj3+81yueTz+WCaJnEcM5/PKcsSXdcRsizjeR6j0YjH40Gr1cJxHAaDAbfbDVHXNbvdjiRJWK1WfL9fLMsiyzI2mw1CVVV836fT6XA8HplMJoRhSK/X43w+I6IoYjabURQFmqbxer1YLBZUVYVhGAhJkrBtm36/z/V6pd1u47ouw+GQ+/3OH4/Fn8FvF/NxAAAAAElFTkSuQmCC" x="0" y="0" width="4" height="4" crossOrigin="anonymous" result="image1"/>
          <feTile x="0" y="0" in="image1" result="tile"/>
          <feBlend mode="overlay" x="0%" y="0%" in="blend1" in2="tile" result="blend2"/>
          <feColorMatrix type="saturate" values="1"/>
          <feComponentTransfer>
            <feFuncR type="discrete" tableValues="0 1"/>
            <feFuncG type="discrete" tableValues="0 1"/>
            <feFuncB type="discrete" tableValues="0 1"/>
          </feComponentTransfer>
        </filter>
        <filter id="chromaticAberrationFilter">
          <feColorMatrix type="matrix" 
            result="red_"             
            values="4 0 0 0 0
                    0 0 0 0 0 
                    0 0 0 0 0 
                    0 0 0 1 0"/>
          <feOffset in="red_" dx="2" dy="0" result="red"/>
          <feColorMatrix type="matrix" 
            in="SourceGraphic"             
            result="blue_"             
            values="0 0 0 0 0
                    0 3 0 0 0 
                    0 0 10 0 0 
                    0 0 0 1 0"/>
          <feOffset in="blue_" dx="-3" dy="0" result="blue"/>    
          <feBlend mode="screen" in="red" in2="blue"/>
        </filter>
      </defs>
    </svg>
    <div id="canvasMessage" class="canvas-message" style="display: none;">
        <h3>
            <span class="step-number">1.</span> Click on tracks <span class="clickable-cube-icon" id="canvasMessageCubeIcon" title="Click to open tracks panel"><ion-icon name="cube-outline"></ion-icon></span> to map a track with a visual pattern (luminode)<br /><br />
            <span class="step-number">2.</span> Select a <strong>MIDI device</strong> and a <strong>Luminode</strong><br /><br />
            <span class="step-number">3.</span> <span>The geometry of light will unfold here</span>
        </h3>
    </div>
    
    <!-- Info Modal -->
    <div id="infoModal" class="info-modal">
        <div class="info-modal-content">
            <div class="info-modal-header">
                <h2>G.L.O.W.</h2>
                <button id="infoModalClose" class="info-modal-close">
                    <ion-icon name="close-outline"></ion-icon>
                </button>
            </div>
            <div id="infoModalBody" class="info-modal-body">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- Save Dialog -->
    <div id="saveDialog" class="save-dialog">
        <div class="save-dialog-content">
            <div class="save-dialog-header">
                <h3>Save Scene</h3>
                <button id="saveDialogClose" class="save-dialog-close">
                    <ion-icon name="close-outline"></ion-icon>
                </button>
            </div>
            <div class="save-dialog-body">
                <div class="scene-name-input">
                    <input 
                        type="text" 
                        id="projectName" 
                        placeholder="Enter scene name" 
                        maxlength="50"
                        autocomplete="off"
                    />
                    <span class="file-extension">.glow</span>
                </div>
            </div>
            <div class="save-dialog-footer">
                <button id="saveDialogCancel" class="btn-secondary">Cancel</button>
                <button id="saveDialogSave" class="btn-primary">Save Scene</button>
            </div>
        </div>
    </div>
    
    <!-- File Picker Dialog -->
    <div id="filePickerDialog" class="file-picker-dialog">
        <div class="file-picker-dialog-content">
            <div class="file-picker-dialog-header">
                <h3>Open Project</h3>
                <button id="filePickerDialogClose" class="file-picker-dialog-close">
                    <ion-icon name="close-outline"></ion-icon>
                </button>
            </div>
            <div class="file-picker-dialog-body">
                <div class="recent-projects-list"></div>
                <p style="margin-top: 20px;">Select a .glow project file to load</p>
                <div class="file-selection-area">
                    <button id="filePickerDialogBrowse" class="btn-primary">
                        <ion-icon name="folder-outline"></ion-icon>
                        Browse Files
                    </button>
                </div>
            </div>
            <div class="file-picker-dialog-footer">
                <button id="filePickerDialogCancel" class="btn-secondary">Cancel</button>
            </div>
        </div>
    </div>
    
    <script type="module" src="src/lib/tweakpane.min.js"></script>
    <script type="module" src="src/lib/tweakpane-plugin-essentials.min.js"></script>
    <script type="module" src="src/components/glow-logo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gpu-io@latest/dist/gpu-io.min.js"></script>
    <script type="module" src="src/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/grained@0.0.2/grained.min.js"></script>
    
    <!-- Ionicons - Using version 5 with inline styles -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <style>
      ion-icon {
        font-size: 1.2em;
        vertical-align: middle;
      }
    </style>
</body>
</html>
